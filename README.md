# KGE_From_Abstract

```markdown
# Система извлечения и анализа графов знаний из текста

Этот проект представляет собой комплексную систему для автоматического построения, уточнения и анализа графов знаний (Knowledge Graphs) из неструктурированных текстов, в частности, научных статей и тезисов. Система выполняет полный цикл обработки: от предварительной подготовки текста до извлечения сущностей, дедупликации, логического вывода и подготовки данных для визуализации.

## Основная идея и конвейер обработки

Процесс преобразования текста в граф знаний разбит на несколько ключевых этапов, каждый из которых реализован в виде отдельного модуля:

1.  **Предварительная обработка текста (`GeminiEnhancedTextProcessor`)**:
    * Исходный текст очищается, нормализуется и сегментируется.
    * Математические формулы ($y' = f(x)$, $E=mc^2$) автоматически обнаруживаются и заменяются на временные метки (`__MATH_FORMULA_X__`), чтобы защитить их от искажения на следующих этапах.
    * С помощью LLM (Gemini) текст анализируется для выявления специфических терминов, аббревиатур и синонимов.

2.  **Извлечение знаний (`ImprovedKnowledgeExtractor`)**:
    * Обработанный текст подается в LLM (Gemini с резервным переключением на локальную модель), которая извлекает из него основные сущности (концепции, методы, инструменты) и связи между ними.
    * Результатом является "сырой" граф знаний.

3.  **Дедупликация сущностей (`EntityDeduplicator`)**:
    * "Сырой" граф очищается от дубликатов. Модуль находит и объединяет семантически или лексически схожие сущности (например, "нейронная сеть" и "нейросеть").

4.  **Логический вывод и анализ (`RDFReasoningEngine`)**:
    * Очищенный граф знаний обогащается новыми связями с помощью логических правил (например, транзитивности: если $A \rightarrow B$ и $B \rightarrow C$, то $A \rightarrow C$).
    * Позволяет выполнять запросы к базе знаний и проверять ее на непротиворечивость.

5.  **Экспорт для визуализации (`gephi_export`)**:
    * Готовый граф знаний преобразуется в формат CSV (`nodes.csv`, `edges.csv`) для дальнейшего анализа и визуализации в программах вроде [Gephi](https://gephi.org/).

## Основные компоненты

### 1. `GeminiEnhancedTextProcessor` — Продвинутая обработка текста
Модуль для подготовки научного текста к анализу.
* **Защита формул**: Находит и изолирует математические выражения.
* **Нормализация**: Приводит текст к единому виду, исправляет знаки препинания и удаляет "шум".
* **Обработка терминологии**: Использует LLM для идентификации аббревиатур, синонимов и ключевых терминов.
* **Тематическая сегментация**: Группирует предложения в тематические блоки на основе семантической близости.

### 2. `ImprovedKnowledgeExtractor` — Извлечение сущностей и связей
Ядро системы, отвечающее за извлечение структурированных данных из текста с помощью языковых моделей.
* **Гибкое использование LLM**: Поддерживает API Gemini с автоматической ротацией ключей и переключением на локальную модель (GPT4All) в случае сбоев.
* **Извлечение сущностей**: Выделяет ключевые понятия (например, "алгоритм", "концепция", "модель").
* **Извлечение связей**: Определяет отношения между сущностями ("является частью", "использует", "определяет").
* **Асинхронность**: Эффективно обрабатывает текстовые чанки с помощью параллельных запросов к API.

### 3. `EntityDeduplicator` — Дедупликация сущностей
Интеллектуальный модуль для слияния дублирующихся узлов в графе.
* **Лексическое сравнение**: Использует точное совпадение, лемматизацию (spaCy) и словари синонимов.
* **Семантический анализ**: Применяет эмбеддинги (`sentence-transformers`) для поиска семантически близких сущностей на основе контекста.

### 4. `RDFReasoningEngine` — Движок логического вывода
Модуль для анализа и обогащения графа знаний.
* **Поиск путей**: Находит и объясняет связи между двумя заданными сущностями.
* **Вывод на основе правил**: Применяет правила транзитивности, симметрии и иерархии для вывода новых фактов.
* **Проверка консистентности**: Ищет логические противоречия и циклы в графе.

### 5. `gephi_export` — Экспорт в Gephi
Утилита для преобразования внутреннего представления графа в формат, совместимый с Gephi.
* Создает файлы узлов (`nodes.csv`) и рёбер (`edges.csv`).
* Сохраняет атрибуты узлов (тип, описание) и рёбер для последующего анализа.

## Структура данных

Система оперирует двумя основными объектами: сущностями и связями.

**Сущность (Entity)**
```json
{
    "id": "unique_id_string",
    "name": "Название сущности",
    "type": "Тип сущности (например, concept, algorithm)",
    "description": "Описание, сгенерированное LLM.",
    "alternative_names": ["синоним1", "синоним2"],
    "source_chunks": [1, 2, 3]
}
```

**Связь (Relation)**
```json
{
    "source": "id_сущности_источника",
    "target": "id_сущности_цели",
    "type": "Тип связи (например, uses, defines, part-of)",
    "description": "Описание связи, подтвержденное контекстом.",
    "source_chunks": [1, 2]
}
```

## Установка

1.  Клонируйте репозиторий:
    ```bash
    git clone [https://github.com/4Ilyas4/KGE_From_Abstract.git](https://github.com/4Ilyas4/KGE_From_Abstract.git)
    cd KGE_From_Abstract
    ```

2.  Установите зависимости:
    *Установите пакеты вручную:*
    ```bash
    pip install spacy sentence-transformers scikit-learn pandas networkx gpt4all pyahocorasick
    ```

3.  Загрузите языковую модель для spaCy:
    ```bash
    python -m spacy download ru_core_news_sm
    ```
4. Вставьте апишки в список


